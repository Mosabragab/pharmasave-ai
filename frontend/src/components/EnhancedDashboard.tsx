'use client'\n\nimport React, { useState, useEffect } from 'react'\nimport Link from 'next/link'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Badge } from '@/components/ui/badge'\nimport TransactionManagement from '@/components/TransactionManagement'\nimport WalletDashboard from '@/components/WalletDashboard'\nimport { \n  ShoppingCart, \n  Package, \n  DollarSign, \n  TrendingUp,\n  Clock,\n  CheckCircle,\n  AlertCircle,\n  Users,\n  BarChart3,\n  Settings,\n  Plus,\n  ArrowRight,\n  Zap,\n  Star,\n  Target,\n  Bell,\n  FileText,\n  Eye\n} from 'lucide-react'\n\ninterface EnhancedDashboardProps {\n  pharmacy: {\n    id: string\n    name: string\n    display_id: string\n  }\n  pharmacist: {\n    id: string\n    fname: string\n    lname: string\n    role: string\n  }\n}\n\nexport default function EnhancedDashboard({ pharmacy, pharmacist }: EnhancedDashboardProps) {\n  const [activeTab, setActiveTab] = useState('overview')\n  const [stats, setStats] = useState({\n    pendingRequests: 0,\n    activeListings: 0,\n    totalEarnings: 0,\n    walletBalance: 0\n  })\n\n  // Mock data loading\n  useEffect(() => {\n    // In real app, load actual stats from API\n    setStats({\n      pendingRequests: 0,\n      activeListings: 0,\n      totalEarnings: 0,\n      walletBalance: 0\n    })\n  }, [pharmacy.id])\n\n  const quickActions = [\n    {\n      title: 'Browse Marketplace',\n      description: 'Find medications from verified pharmacies',\n      icon: <ShoppingCart className=\"w-5 h-5\" />,\n      href: '/marketplace',\n      primary: true\n    },\n    {\n      title: 'Create Listing',\n      description: 'List near-expired medications',\n      icon: <Plus className=\"w-5 h-5\" />,\n      href: '/listings/create'\n    },\n    {\n      title: 'Transaction History',\n      description: 'View all your transactions',\n      icon: <BarChart3 className=\"w-5 h-5\" />,\n      href: '/transactions'\n    },\n    {\n      title: 'My Listings',\n      description: 'Manage your active listings',\n      icon: <Package className=\"w-5 h-5\" />,\n      href: '/listings'\n    }\n  ]\n\n  const recentActivities = [\n    {\n      id: 1,\n      type: 'request',\n      title: 'New purchase request received',\n      description: 'Paracetamol 500mg - 5 minutes ago',\n      time: '5 minutes ago',\n      status: 'new',\n      icon: <ShoppingCart className=\"w-4 h-4\" />\n    },\n    {\n      id: 2,\n      type: 'expiry',\n      title: 'Medication expires soon',\n      description: 'Paracetamol 500mg listing expires in 2 days',\n      time: '1 hour ago',\n      status: 'urgent',\n      icon: <Clock className=\"w-4 h-4\" />\n    },\n    {\n      id: 3,\n      type: 'payment',\n      title: 'Payment received',\n      description: 'Payment received: 450 EGP',\n      time: '3 hours ago',\n      status: 'completed',\n      icon: <DollarSign className=\"w-4 h-4\" />\n    }\n  ]\n\n  const getActivityColor = (status: string) => {\n    switch (status) {\n      case 'new': return 'text-blue-600'\n      case 'urgent': return 'text-orange-600'\n      case 'completed': return 'text-green-600'\n      default: return 'text-gray-600'\n    }\n  }\n\n  const getActivityBg = (status: string) => {\n    switch (status) {\n      case 'new': return 'bg-blue-50 dark:bg-blue-900/20'\n      case 'urgent': return 'bg-orange-50 dark:bg-orange-900/20'\n      case 'completed': return 'bg-green-50 dark:bg-green-900/20'\n      default: return 'bg-gray-50 dark:bg-gray-900/20'\n    }\n  }\n\n  return (\n    <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n      {/* Welcome Section */}\n      <div className=\"mb-8\">\n        <h1 className=\"text-3xl font-bold text-gray-900 dark:text-white mb-2\">\n          Good evening, {pharmacist.fname}! ðŸ‘‹\n        </h1>\n        <p className=\"text-gray-600 dark:text-gray-400\">\n          {pharmacy.name} â€¢ {pharmacy.display_id}\n        </p>\n      </div>\n\n      {/* Stats Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8\">\n        <Card className=\"bg-white dark:bg-slate-800 border-gray-200 dark:border-slate-700\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm text-gray-600 dark:text-gray-400\">Pending Requests</p>\n                <p className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n                  {stats.pendingRequests}\n                </p>\n                <p className=\"text-xs text-gray-500\">Needs attention</p>\n              </div>\n              <div className=\"w-10 h-10 bg-yellow-100 dark:bg-yellow-900/20 rounded-lg flex items-center justify-center\">\n                <Clock className=\"w-5 h-5 text-yellow-600 dark:text-yellow-400\" />\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"bg-white dark:bg-slate-800 border-gray-200 dark:border-slate-700\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm text-gray-600 dark:text-gray-400\">Active Listings</p>\n                <p className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n                  {stats.activeListings}\n                </p>\n                <p className=\"text-xs text-gray-500\">In marketplace</p>\n              </div>\n              <div className=\"w-10 h-10 bg-blue-100 dark:bg-blue-900/20 rounded-lg flex items-center justify-center\">\n                <Package className=\"w-5 h-5 text-blue-600 dark:text-blue-400\" />\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"bg-white dark:bg-slate-800 border-gray-200 dark:border-slate-700\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm text-gray-600 dark:text-gray-400\">Total Earnings</p>\n                <p className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n                  {stats.totalEarnings} EGP\n                </p>\n                <p className=\"text-xs text-gray-500\">This month</p>\n              </div>\n              <div className=\"w-10 h-10 bg-green-100 dark:bg-green-900/20 rounded-lg flex items-center justify-center\">\n                <TrendingUp className=\"w-5 h-5 text-green-600 dark:text-green-400\" />\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"bg-white dark:bg-slate-800 border-gray-200 dark:border-slate-700\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm text-gray-600 dark:text-gray-400\">Wallet Balance</p>\n                <p className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n                  {stats.walletBalance} EGP\n                </p>\n                <p className=\"text-xs text-gray-500\">Available funds</p>\n              </div>\n              <div className=\"w-10 h-10 bg-pharmacy-green/10 dark:bg-pharmacy-green/20 rounded-lg flex items-center justify-center\">\n                <DollarSign className=\"w-5 h-5 text-pharmacy-green dark:text-pharmacy-green\" />\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Tabs Navigation */}\n      <div className=\"border-b border-gray-200 dark:border-slate-700 mb-8\">\n        <nav className=\"flex space-x-8\">\n          <button\n            onClick={() => setActiveTab('overview')}\n            className={`pb-4 px-1 border-b-2 font-medium text-sm transition-colors ${\n              activeTab === 'overview'\n                ? 'border-pharmacy-green text-pharmacy-green'\n                : 'border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300'\n            }`}\n          >\n            Overview\n          </button>\n          <button\n            onClick={() => setActiveTab('transactions')}\n            className={`pb-4 px-1 border-b-2 font-medium text-sm transition-colors ${\n              activeTab === 'transactions'\n                ? 'border-pharmacy-green text-pharmacy-green'\n                : 'border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300'\n            }`}\n          >\n            Transactions\n          </button>\n          <button\n            onClick={() => setActiveTab('wallet')}\n            className={`pb-4 px-1 border-b-2 font-medium text-sm transition-colors ${\n              activeTab === 'wallet'\n                ? 'border-pharmacy-green text-pharmacy-green'\n                : 'border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300'\n            }`}\n          >\n            Wallet\n          </button>\n        </nav>\n      </div>\n\n      {/* Tab Content */}\n      {activeTab === 'overview' && (\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          {/* Quick Actions */}\n          <div className=\"lg:col-span-2\">\n            <Card className=\"bg-white dark:bg-slate-800 border-gray-200 dark:border-slate-700\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center space-x-2\">\n                  <Zap className=\"w-5 h-5 text-pharmacy-green\" />\n                  <span>Quick Actions</span>\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  {quickActions.map((action, index) => (\n                    <Link key={index} href={action.href}>\n                      <div className={`p-4 rounded-lg border transition-all duration-200 hover:shadow-md cursor-pointer ${\n                        action.primary \n                          ? 'border-pharmacy-green bg-pharmacy-green/5 hover:bg-pharmacy-green/10'\n                          : 'border-gray-200 dark:border-slate-600 hover:border-gray-300 dark:hover:border-slate-500'\n                      }`}>\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center space-x-2 mb-2\">\n                              <div className={`p-1 rounded ${\n                                action.primary \n                                  ? 'bg-pharmacy-green/20 text-pharmacy-green'\n                                  : 'bg-gray-100 dark:bg-slate-700 text-gray-600 dark:text-gray-400'\n                              }`}>\n                                {action.icon}\n                              </div>\n                              <h3 className=\"font-medium text-gray-900 dark:text-white\">\n                                {action.title}\n                              </h3>\n                            </div>\n                            <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                              {action.description}\n                            </p>\n                          </div>\n                          <ArrowRight className=\"w-4 h-4 text-gray-400 ml-2\" />\n                        </div>\n                      </div>\n                    </Link>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Recent Activity */}\n          <div>\n            <Card className=\"bg-white dark:bg-slate-800 border-gray-200 dark:border-slate-700\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center space-x-2\">\n                    <Clock className=\"w-5 h-5 text-trust-blue\" />\n                    <span>Recent Activity</span>\n                  </div>\n                  <Badge variant=\"outline\" className=\"text-xs\">\n                    Live\n                  </Badge>\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  {recentActivities.map((activity) => (\n                    <div key={activity.id} className={`p-3 rounded-lg ${getActivityBg(activity.status)}`}>\n                      <div className=\"flex items-start space-x-3\">\n                        <div className={`p-1 rounded ${getActivityColor(activity.status)} bg-white dark:bg-slate-800`}>\n                          {activity.icon}\n                        </div>\n                        <div className=\"flex-1 min-w-0\">\n                          <p className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                            {activity.title}\n                          </p>\n                          <p className=\"text-xs text-gray-600 dark:text-gray-400 mt-1\">\n                            {activity.description}\n                          </p>\n                          <p className=\"text-xs text-gray-500 mt-1\">\n                            {activity.time}\n                          </p>\n                        </div>\n                        {activity.status === 'new' && (\n                          <Badge variant=\"default\" className=\"text-xs\">\n                            New\n                          </Badge>\n                        )}\n                        {activity.status === 'urgent' && (\n                          <Badge variant=\"destructive\" className=\"text-xs\">\n                            Urgent\n                          </Badge>\n                        )}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      )}\n\n      {activeTab === 'transactions' && (\n        <TransactionManagement\n          pharmacyId={pharmacy.id}\n          pharmacistId={pharmacist.id}\n        />\n      )}\n\n      {activeTab === 'wallet' && (\n        <WalletDashboard\n          pharmacyId={pharmacy.id}\n          pharmacistId={pharmacist.id}\n        />\n      )}\n    </div>\n  )\n}\n